{{ fn('timber_set_product', post) }}

<div id="{{ post.id }}" class="entry item grid-item product-grid-item product-tease {{ post.class }}" data-product-id="{{ post.id }}">
  
  <!-- woocommerce_template_loop_product_link_open fires here; this action is removed -->
  {% do action('woocommerce_before_shop_loop_item') %}
  
  <!-- the product thumbnail -->
  <div class="tease-image uk-position-relative">
    <a href="{{ post.link }}">
      <!-- woocommerce_template_loop_product_thumbnail fires here; this action is removed. custom image markup is used below -->
      {% do action('woocommerce_before_shop_loop_item_title') %}
      <img data-src="{{ post.thumbnail.src|resize(900, 1200) }}" alt="{{ post.thumbnail.alt }}" uk-img>
    </a>
  </div>
  
  <!-- the product details -->
  <div class="tease-details uk-margin-small-top">
    
    {% if post._lottery_dates_to and not post._lottery_closed %}
      <div class="finishes uk-text-small uk-grid-collpase uk-grid-match uk-flex uk-flex-middle" uk-grid>

      <div class="completion_meta uk-width-expand@m">
        
        {% set days_left = fn('dates_to_days', post._lottery_dates_to) %}
        {% set hours_left = fn('times_to_hours', post._lottery_dates_to) %}
        {% set human_time_left = fn('human_time_diff', post._lottery_dates_to|date("U"), fn('current_time', 'timestamp')) %}
        
        {% if days_left > 14 %}
          <span class="uk-text-meta">Just over {{human_time_left}} left</span>
        {% elseif days_left <= 14 and days_left > 0 %}
          <span class="uk-text-warning">Just over {{human_time_left}} left!</span>
        {% elseif days_left == 0 %}
          <span class="uk-text-danger">Just {{human_time_left}} left!</span>
        {% endif %}
        
      </div>
      <div class="tickets-meta uk-width-auto@m">
        {% set tickets_left = post._max_tickets - post._lottery_participants_count %}
        {% if tickets_left > 25 %}
          <span class="uk-text-meta">{{tickets_left}} Tickets left</span>
        {% elseif tickets_left <= 25 and time_left > 10 %}
          <span class="uk-text-warning">Just {{tickets_left}} Left!</span>
        {% elseif tickets_left <= 10 %}
          <span class="uk-text-danger">Only {{tickets_left}} Left!</span>
        {% endif %}
      </div>
      
    </div>
    {% endif %}
    
    <!-- the product title -->
    <div class="tease-title">
      <!-- woocommerce_template_loop_product_title fires here; this action is removed. custom title markup is used below -->
      {% do action('woocommerce_shop_loop_item_title') %}
      <h3 class="uk-h4">
        <a class="uk-link-reset" href="{{ post.link }}">{{ post.title }}</a>
      </h3>
    </div>
    
    <!-- the product price & rating, uses the default action for these: woocommerce_after_shop_loop_item_title  -->
    <div class="tease-price-rating uk-margin-small-bottom">
      <span class="uk-form-label">Price of Entry: </span>
      {% do action('woocommerce_after_shop_loop_item_title') %}
    </div>
    
    <!-- the product add to cart buttons, uses the default action for these: woocommerce_after_shop_loop_item -> woocommerce_template_loop_add_to_cart. woocommerce_template_loop_product_link_close has been removed -->
    <div class="tease-buttons">
      {% do action( 'woocommerce_after_shop_loop_item' ) %}
    </div>
    
  </div>
</div>