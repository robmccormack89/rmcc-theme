{% extends 'shop.twig' %}

{% block contentwrap %}

  <div class="uk-container" data-block="content-wrap" data-template="product-cat.twig">
    
    {% do action('woocommerce_before_main_content') %}
    
    <div class="shop-wrap">

      {% do action('woocommerce_before_shop_loop') %}

      {% if sub_cats is not empty %} 
      
        <div class="uk-child-width-1-{{columns}}@m uk-grid-small" uk-grid>
      
          {% for sub_cat in sub_cats %}
          
            {% set thumb_id = fn('get_term_meta', sub_cat.term_id, 'thumbnail_id', true ) %}
            {% set thumb_link = fn('wp_get_attachment_url', thumb_id) %}
            {% if thumb_link is not empty %}
              {% set thumb_url = thumb_link %}
            {% else %}
              {% set thumb_url = 'https://via.placeholder.com/500x500.png?text=+' %}
            {% endif %}
            
            <div>
              <a href="{{fn('get_term_link', sub_cat.term_id)}}">
                <img data-src="{{ thumb_url }}" data-width data-height alt="" uk-img>
              </a>
            </div> 
             
          {% endfor %}
          
        </div>
        
      {% else %}
      
        {% if products is not empty %}
          <div id="ProductsGrid" class="uk-child-width-1-1 uk-child-width-1-{{columns}}@m uk-grid-small archive-posts" uk-grid="masonry: true">
            {% for post in products %}
              {% include ['tease-product.twig'] %}
            {% endfor %}
          </div>
          {% if is_paginated %}
            {% include 'pagination.twig' with { pagination : products.pagination( { show_all: true, mid_size: 3, end_size: 2 } ) } %}
          {% endif %}
        {% else %}
          {% do action('woocommerce_no_products_found') %}
        {% endif %}
        
      {% endif %}

      {% do action('woocommerce_after_shop_loop') %}

      {% do action('woocommerce_after_main_content') %}
      
    </div>
    
  </div>

{% endblock %}